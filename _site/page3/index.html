<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Joswlv</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="/css/fontawesome/css/font-awesome.min.css ">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://joswlv.github.io/page3/">
    <link rel="alternate" type="application/rss+xml" title="Joswlv" href="http://joswlv.github.io/feed.xml ">



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83868242-1', 'auto');
  ga('send', 'pageview');

</script>

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">Joswlv</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <!-- <h1>Welcome to SW's Blog!</h1>
        <small></small> -->
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/20/mybatis_log/">mybatis log출력</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-20
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="mybatis--">1. mybatis 로그 출력</h1>

<p>데이터베이스 입출력을 로그로 볼 수 있는 기능이 mybatis에 있다. mybatis설정 파일에 다음과 같이 편집을 한다.</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/09/20/mybatis_log/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/18/mybatis/">mybatis 개론</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-18
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="mybatis">1. mybatis소개</h1>

<h3 id="persistence">퍼시스턴스(Persistence)프레임워크</h3>

<p>퍼시스턴스라는 용어는 개발 분야에서 많이 사용하는 용어이다. 데이터의 지속성을 의마하는 용어로 어플리케이션을 종료하고 다시 실행하더라도 이전에 저장한 데이터를 다시 불러올 수 있는 기술이다.</p>

<p>퍼시스턴스 프레임워크는 데이터의 저장, 조회, 변경, 삭제를 다루는 클래스 및 설정 파일들의 집합니다. 이를 사용하면 JDBC 프로그래밍의 복잡함이나 번거로움 없이 간단한 작업 만으로 데이터베이스와 연동되는 시스템을 빠르고 안전적으로 구동되게 개발할 수 있다.</p>

<p>퍼시스턴스 프레임워크에는 SQL문장으로 직접 DB데이터를 다루는 <code class="highlighter-rouge">SQL맵퍼(mapper)</code>와 자바객체를 통해 간접적으로 DB데이터를 다루는 <code class="highlighter-rouge">객체 관계 맵퍼(Object-Relational mapper)</code>가 있다.</p>

<p>SQL맵퍼에 대표적으로 `mybatis가 있고, 객체 관계 맵퍼에는 Hibernate와 TopLink가 있다.</p>

<p>객체관계맵퍼는 프레임워크에서 제공하는 API와 전용 객체 질의어를 사용하여 데이터를 다룬다. 그래서 이를 사용할려면 데이터베이스의 정규화가 잘돼 있어야 한다. 그래야만 테이블을 객체와 연결하기 쉽고, 객체를 통해 테이블의 데이터를 다루기가 쉽다. 근데, 유지보수 단계에 들어가면 잦은 기는 변경과 추가로 데이터베이스구조가 흐트러지게 되어 실무에서는 잘 사용하지 않는다.</p>

<p>mybatis의 핵심은 개발과 유지보수가 쉽도록 소스코드에 박혀있는 SQL을 별도의 파일로 분리하는 것이다. 또 단순하고 반복적인 JDBC코드를 캡슐화하여 데이터베이스 프로그래밍을 간결하게 하는것이다.</p>

<p>라이브러리 파일은 <a href="http://github.com/mybatis">http://github.com/mybatis</a>에서 <code class="highlighter-rouge">mybatis-3</code>로 가서 다운 받는다.</p>

<p><br /></p>

<h1 id="mybatis-">2. mybatis 구동하기</h1>

<h3 id="mybatis-----">mybatis를 이용한 프로젝트 목록 가져오기 시나리오</h3>

<ol>
  <li>MySqlProjectDao는 SqlSessionFactory에게 SQL을 실행할 객체를 요구한다.</li>
  <li>SqlSessionFactory는 SqlSession 객체를 생성하여 반환한다.</li>
  <li>MySqlProjectDao는 SqlSession객체에게 SQL 실행을 요청한다.</li>
  <li>SqlSession객체는 SQL이 저장된 맵퍼 파일에서 SQL을 찾는다.</li>
  <li>SqlSession은 JDBC드라이버를 통해 데이터베이스에 질의를 실행한다.</li>
  <li>SqlSession은 데이터베이스로부터 가져온 데이터로 Project목록을 생성하여 반환한다.</li>
  <li>MySqlProjectDao는 사용이 끝난 SqlSession을 닫는다.
<br /></li>
</ol>

<h3 id="mybatis---">mybatis 프레임워크의 핵심 컴포넌트</h3>

<table>
  <thead>
    <tr>
      <th>컴포넌트</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SqlSession</td>
      <td>실제 SQL을 실행하는 객체. 이 객체는 SQL을 처리하기 위해 JDBC 드라이버를 사용함</td>
    </tr>
    <tr>
      <td>SqlSessionFactory</td>
      <td>SqlSession 객체를 생성함</td>
    </tr>
    <tr>
      <td>SqlSessionFactoryBuilder</td>
      <td>mysql설정 파일의 내용을 토대로 SqlSessionFactory를 생성함.</td>
    </tr>
    <tr>
      <td>mybatis설정파일</td>
      <td>데이터베이스 연결정보, 트갠잭션정보,  mybatis제어 정보 등의 설정 내용을 포함하고 있음. SqlSessionFactory를 만들 때 사용됨.</td>
    </tr>
    <tr>
      <td>SQL 맵퍼 파일</td>
      <td>SQL문을 담고 있는 파일. SqlSession객체가 참조함.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="sqlsession--">SqlSession의 주요 메서드</h3>

<table>
  <thead>
    <tr>
      <th>메서드</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>selectList()</td>
      <td>SELECT문을 실행. 값객체(Value Object) 목록을 반환함</td>
    </tr>
    <tr>
      <td>selectOne()</td>
      <td>SELECT문을 실행. 하나의 값 객체를 반환함</td>
    </tr>
    <tr>
      <td>insert()</td>
      <td>INSERT문을 실행. 반환값은 입력 데이터 개수.</td>
    </tr>
    <tr>
      <td>update()</td>
      <td>UPDATE문을 실행. 반환값은 변경한 데이터 개수.</td>
    </tr>
    <tr>
      <td>delete()</td>
      <td>DELETE문을 실행. 반환값은 삭제한 데이터 개수.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>예&gt;</strong></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Component</span><span class="o">(</span><span class="s">"projectDao"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MySqlProjectDao</span> <span class="kd">implements</span> <span class="n">ProjectDao</span> <span class="o">{</span>
  <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSqlSessionFactory</span><span class="o">(</span><span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">sqlSessionFactory</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Project</span><span class="o">&gt;</span> <span class="nf">selectList</span><span class="o">(</span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">paramMap</span><span class="o">)</span> 
  		<span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.selectList"</span><span class="o">,</span> <span class="n">paramMap</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="n">Project</span> <span class="n">project</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>  <span class="o">{</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.insert"</span><span class="o">,</span> <span class="n">project</span><span class="o">);</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="kd">public</span> <span class="n">Project</span> <span class="nf">selectOne</span><span class="o">(</span><span class="kt">int</span> <span class="n">no</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span> 
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectOne</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.selectOne"</span><span class="o">,</span> <span class="n">no</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="o">....</span>
  
</code></pre>
</div>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//MySqlProjectDao.xml -&gt; 맵퍼파일
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"spms.dao.ProjectDao"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"project"</span> <span class="na">id=</span><span class="s">"projectResultMap"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"PNO"</span> <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"PNAME"</span>    <span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"CONTENT"</span>  <span class="na">property=</span><span class="s">"content"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"STA_DATE"</span> <span class="na">property=</span><span class="s">"startDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"END_DATE"</span> <span class="na">property=</span><span class="s">"endDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"STATE"</span>    <span class="na">property=</span><span class="s">"state"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"CRE_DATE"</span> <span class="na">property=</span><span class="s">"createdDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"TAGS"</span>     <span class="na">property=</span><span class="s">"tags"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/resultMap&gt;</span>
  
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectList"</span> <span class="na">parameterType=</span><span class="s">"map"</span> <span class="na">resultMap=</span><span class="s">"projectResultMap"</span><span class="nt">&gt;</span>
    select PNO, PNAME, STA_DATE, END_DATE, STATE
    from PROJECTS
    order by
    <span class="nt">&lt;choose&gt;</span> 
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'TITLE_ASC'"</span><span class="nt">&gt;</span>PNAME asc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'TITLE_DESC'"</span><span class="nt">&gt;</span>PNAME desc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'STARTDATE_ASC'"</span><span class="nt">&gt;</span>STA_DATE asc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'STARTDATE_DESC'"</span><span class="nt">&gt;</span>STA_DATE desc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'ENDDATE_ASC'"</span><span class="nt">&gt;</span>END_DATE asc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'ENDDATE_DESC'"</span><span class="nt">&gt;</span>END_DATE desc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'STATE_ASC'"</span><span class="nt">&gt;</span>STATE asc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'STATE_DESC'"</span><span class="nt">&gt;</span>STATE desc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">"orderCond == 'PNO_ASC'"</span><span class="nt">&gt;</span>PNO asc<span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;otherwise&gt;</span>PNO desc<span class="nt">&lt;/otherwise&gt;</span>
    <span class="nt">&lt;/choose&gt;</span>
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insert"</span> <span class="na">parameterType=</span><span class="s">"project"</span><span class="nt">&gt;</span>
    insert into PROJECTS(PNAME,CONTENT,STA_DATE,END_DATE,STATE,CRE_DATE,TAGS)
    values (#{title},#{content},#{startDate},#{endDate},0,now(),#{tags})
  <span class="nt">&lt;/insert&gt;</span>
  
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"selectOne"</span> <span class="na">parameterType=</span><span class="s">"int"</span> <span class="na">resultMap=</span><span class="s">"projectResultMap"</span><span class="nt">&gt;</span>
    select PNO, PNAME, CONTENT, STA_DATE, END_DATE, STATE, CRE_DATE, TAGS
    from PROJECTS 
    where PNO=#{value}
  <span class="nt">&lt;/select&gt;</span>
  
  ...
  
</code></pre>
</div>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">spms</span><span class="o">.</span><span class="na">listeners</span><span class="o">;</span>

<span class="c1">// SqlSessionFactory 객체 준비</span>
<span class="nd">@WebListener</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ContextLoaderListener</span> <span class="kd">implements</span> <span class="n">ServletContextListener</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="n">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">;</span>
  
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApplicationContext</span> <span class="nf">getApplicationContext</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">applicationContext</span><span class="o">;</span>
  <span class="o">}</span>
   
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">contextInitialized</span><span class="o">(</span><span class="n">ServletContextEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ApplicationContext</span><span class="o">();</span>
      
      <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">"spms/dao/mybatis-config.xml"</span><span class="o">;</span>
      <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
      <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> 
          <span class="k">new</span> <span class="nf">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>	
      <span class="c1">//SqlSessionFactory객체를 mybatis설정파일(설계도)를 통해 빌드 시킴</span>
      <span class="c1">//이런식의 객체 생성 패턴을 빌더 패턴(Builder Pattern)이라고 한다.</span>
      
      <span class="n">applicationContext</span><span class="o">.</span><span class="na">addBean</span><span class="o">(</span><span class="s">"sqlSessionFactory"</span><span class="o">,</span> <span class="n">sqlSessionFactory</span><span class="o">);</span>
      
      <span class="n">ServletContext</span> <span class="n">sc</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
      <span class="n">String</span> <span class="n">propertiesPath</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span>
          <span class="n">sc</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">"contextConfigLocation"</span><span class="o">));</span>
      
      <span class="n">applicationContext</span><span class="o">.</span><span class="na">prepareObjectsByProperties</span><span class="o">(</span><span class="n">propertiesPath</span><span class="o">);</span>
      
      <span class="n">applicationContext</span><span class="o">.</span><span class="na">prepareObjectsByAnnotation</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
      
      <span class="n">applicationContext</span><span class="o">.</span><span class="na">injectDependency</span><span class="o">();</span>
      
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">contextDestroyed</span><span class="o">(</span><span class="n">ServletContextEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">}</span>
</code></pre>
</div>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//mybatis 설정파일
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;settings&gt;</span>
    <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"logImpl"</span> <span class="na">value=</span><span class="s">"LOG4J"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/settings&gt;</span>
      
  <span class="nt">&lt;typeAliases&gt;</span>
    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">"spms.vo.Project"</span> <span class="na">alias=</span><span class="s">"project"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">"spms.vo.Member"</span> <span class="na">alias=</span><span class="s">"member"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/typeAliases&gt;</span>
  
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"JNDI"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"data_source"</span> <span class="na">value=</span><span class="s">"java:comp/env/jdbc/studydb"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"spms/dao/MySqlProjectDao.xml"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"spms/dao/MySqlMemberDao.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre>
</div>

<p><br /></p>

<h5 id="commit-rollback">commit()과 rollback()메서드</h5>

<p>DBMS는 INSERT, UPDATE, DELETE문을 실행하면 그 작업 결과를 임시 데이터베이스에 보관한다. 클라이언트 요청이 있어야만 임시 데이터베이스의 작업물을 운영 데이터베이스에 반영한다.</p>

<p><code class="highlighter-rouge">commit()</code>은 임시 데이터베이스에 보관된 작업 결과를 운영 데이터베이스에 적용하라고 요청할 때 사용하는 메서드이다.</p>

<p><code class="highlighter-rouge">rollback()</code>은 임시 데이터베이스의 작업 결과를 운영 데이터베이스에 반영하지 않고 취소할 때 호출한다.</p>

<h3 id="sql-">SQL맵퍼 파일</h3>

<p><strong>DTD선언</strong></p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
</code></pre>
</div>

<h4 id="mapper--"><code class="highlighter-rouge">&lt;mapper&gt;</code> 루트 엘리먼트</h4>

<p>SQL 맵퍼 파일은 루트 엘리먼트 <code class="highlighter-rouge">&lt;mapper&gt;</code>를 작성하는 것으로 시작한다. <code class="highlighter-rouge">namespace</code>속성은 자바의 패키지처럼 SQL문을 묶는 용도로 사용한다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;mapper</span> <span class="na">namespace =</span><span class="s">"spms.dao.ProjectDao"</span><span class="nt">&gt;</span>

...

<span class="nt">&lt;/mapper&gt;</span>
</code></pre>
</div>

<h4 id="select-insert-update-delete-"><code class="highlighter-rouge">&lt;select&gt;</code>, <code class="highlighter-rouge">&lt;insert&gt;</code>, <code class="highlighter-rouge">&lt;update&gt;</code>, <code class="highlighter-rouge">&lt;delete&gt;</code> 엘리먼트</h4>

<p>SQL문을 작성할 때 명령어에 맞는 태그를 사용한다.</p>

<p><strong>id속성</strong> -&gt; SQL문을 작성할때 각각의 SQL문을 구분하기 위해 id 속성을 사용한다.</p>

<p><strong>resultType속성</strong> -&gt; select문을 실행하면 결과가 생성되는데, 이 결과를 담을 객체를 지정하는 속성이 resultType속성이다. 값으로는 클래스 이름(패키지 이름 포함)이 온다.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;select id="selectList" resultType="spms.vo.Project"&gt;
</code></pre>
</div>

<p>만약 mybatis 설정 파일에 다음과 같이 spms.vo.Project에 대한 별명이 정의 되여 있다면 resultType의 값으로 그 별명을 사용할 수 있다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//mybatis설정 파일의 일부분
  <span class="nt">&lt;typeAliases&gt;</span>
    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">"spms.vo.Project"</span> <span class="na">alias=</span><span class="s">"project"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">"spms.vo.Member"</span> <span class="na">alias=</span><span class="s">"member"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/typeAliases&gt;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;select id="selectList" resultType="project"&gt;
</code></pre>
</div>

<p><br /></p>

<p>위 방법에 약간의 번거러움이 있다. mybatis는 SELECT 결과를 저장하고자 resultTpye에 선언된 클래스의 인스턴스를 생성한다. 그리고 각 칼럼에 대응하는 값객체의 셋터 메서드를 찾아서 호출한다. 이때 셋터메서드는 대소문자 구분없이 set을 뺀 메서드의 이름이과 칼럼의 이름이 같아야지만 인스턴스가 생성된다.</p>

<p>만약 칼럼의 이름과 일치하는 셋터가 없다면, 해당 칼럼의 값은 인스턴스에 저장되지 않는다.
이런 점이 매우 번거럽다. 이를 해결하기 위해 다음 엘리먼트를 사용한다.</p>

<p><br /></p>

<h4 id="resultmap-"><code class="highlighter-rouge">&lt;resultMap&gt;</code> 엘리먼트</h4>

<p>다음과 같이 <code class="highlighter-rouge">&lt;resultMap&gt;</code>태그에 칼럼과 연결될 값객체의 셋터 메서드를 정의한다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>  <span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"project"</span> <span class="na">id=</span><span class="s">"projectResultMap"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"PNO"</span> <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"PNAME"</span>    <span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"CONTENT"</span>  <span class="na">property=</span><span class="s">"content"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"STA_DATE"</span> <span class="na">property=</span><span class="s">"startDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"END_DATE"</span> <span class="na">property=</span><span class="s">"endDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"STATE"</span>    <span class="na">property=</span><span class="s">"state"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"CRE_DATE"</span> <span class="na">property=</span><span class="s">"createdDate"</span> <span class="na">javaType=</span><span class="s">"java.sql.Date"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"TAGS"</span>     <span class="na">property=</span><span class="s">"tags"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/resultMap&gt;</span>
</code></pre>
</div>

<p>`<resultMap>태그의 type 값은 칼럼 데이터를 저장할 클래스 이름 또는 클래스의 별명이다. 클래스에 대한 별명은 mybatis설정파일에 정의 했다. 앞의 소스에서는 type 값을 project라고 하였는데, spms.vo.Project 클래스를 가리키는 별명이다.</resultMap></p>

<blockquote>
  <p><strong><code class="highlighter-rouge">&lt;result&gt;</code> 엘리먼트</strong></p>

  <p><code class="highlighter-rouge">&lt;resultMap&gt;</code> 태그의 자식 태그로서 칼럼과 셋터 메서드의 연결을 정의한다. column 속성에는 칼럼 이름을 지정하고, property 속성에는 객체의 프로퍼티 이름을 지정한다.</p>
  <blockquote>
    <div class="highlighter-rouge"><pre class="highlight"><code>&lt;result column="PNAME" property="title"/&gt;
</code></pre>
    </div>
    <p><code class="highlighter-rouge">&lt;result&gt;</code>태그를 사용하여 PNAME 칼럼 값을 setTitle()메서드와 연결시킨것을 보았다.</p>
  </blockquote>
</blockquote>

<p><br /></p>

<blockquote>
  <p><strong>javaType속성</strong></p>

  <p><code class="highlighter-rouge">&lt;result&gt;</code>에서 javaType을 사용하면, 칼럼의 값을 특정 자바 객체로 변환할 수 있다. 다음과 같이 STA_DATE 칼럼에 대해 javaType을 java.sql.Date으로 설정하면, 칼럼 값을 꺼낼 때 그 객체로 변환된다.</p>
</blockquote>

<p><br /></p>

<blockquote>
  <p><strong><code class="highlighter-rouge">&lt;id&gt;</code> 엘리먼트</strong></p>

  <p><code class="highlighter-rouge">&lt;id&gt;</code>태그는 <code class="highlighter-rouge">&lt;result&gt;</code>태그와 작성법이 같다. 다만 <code class="highlighter-rouge">&lt;id&gt;</code>태그에서 지정한 프로퍼티는 객체 식별자로 사용된다. SELECT문을 실행하면 레코드 값을 저장하기 위해 결과 객체가 생성되는데, SELECT문을 실행할 때마다 매번 결과 객체를 생성한다면 실행 성능이 나빠진다. 이를 해결하기위해 SELECT를 통해 생성된 결과 객체들은 별도의 보관소에 저장(캐싱, chaching)해두고 재사용한다. 이때 보관소에 저장된 객체를 구분하는 값으로 <code class="highlighter-rouge">&lt;id&gt;</code>에서 지정한 프로퍼티를 사용한다.</p>
</blockquote>

<h4 id="sql---">SQL문의 입력 매개변수 처리</h4>

<p>mybatis에서는 입력 매개벼수를 <code class="highlighter-rouge">#{프로퍼티명}</code>으로 표시한다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insert"</span> <span class="na">parameterType=</span><span class="s">"project"</span><span class="nt">&gt;</span>
    insert into PROJECTS(PNAME,CONTENT,STA_DATE,END_DATE,STATE,CRE_DATE,TAGS)
    values (#{title},#{content},#{startDate},#{endDate},0,now(),#{tags})
  <span class="nt">&lt;/insert&gt;</span>
</code></pre>
</div>

<p><br /></p>

<p><code class="highlighter-rouge">#{프로퍼티명}</code>이 가리키는 값은 <code class="highlighter-rouge">&lt;insert&gt;</code>의 paramerType에 지정한 객체의 프로퍼티 값(겟터 메서드의 반환값)이다. 즉 #{title} 자리에는 Project객체의 getTitle() 반환값이 놓인다.</p>

<p><br /></p>

<h4 id="section">입력매개변수에 값 공급</h4>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="n">Project</span> <span class="n">project</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>  <span class="o">{</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.insert"</span><span class="o">,</span> <span class="n">project</span><span class="o">);</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">sqlSession.insert()</code>를 호출하면 SQL 맵퍼 파일에서 <code class="highlighter-rouge">spms.dao.ProjectDao.insert</code>아이디를가진 SQL문을 찾아 실행한다. 물론 <code class="highlighter-rouge">spms.dao.ProjectDao</code>는 SQL 맵퍼 파일의 네임스페이스 이름을 가리키고 insert는 SQL 아이드를 가리킨다. project는 INSERT문을 실행할 때 입력 매개변수에 값을 공급할 객체이다.</p>

<p>만약 다음과 같이 공급하는 객체가 기본 타입 객체(랩퍼클래스,wrapper class)인 경우, 자바는 해당 타입에 대응하는 랩퍼 객체를 생성하여 자동포장 한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">delete</span><span class="o">(</span><span class="kt">int</span> <span class="n">no</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>  
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.delete"</span><span class="o">,</span> <span class="n">no</span><span class="o">);</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
      <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>

<p>즉 컴파일 할때 다음과 같이 변한다.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">sqlSEssion</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="s">"spms.dao.ProjectDao.delete"</span><span class="o">,</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">no</span><span class="o">));</span>
</code></pre>
</div>

<p><br /></p>

<h3 id="mybatis--">mybatis 설정 파일</h3>

<p><strong>DTD선언</strong></p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
</code></pre>
</div>
<p><br /></p>

<h4 id="configuration--"><code class="highlighter-rouge">&lt;configuration&gt;</code> 루트 엘리먼트</h4>

<p><strong>configuration의 주요 자식 엘리먼트</strong></p>

<table>
  <thead>
    <tr>
      <th>엘리먼트</th>
      <th>용도</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>properties</td>
      <td>프로퍼티 파일이 있는 경로 설정. <property>를 사용하여 개별 프로퍼티 정의 가능</property></td>
    </tr>
    <tr>
      <td>settings</td>
      <td>프레임워크의 실행 환경을 설정</td>
    </tr>
    <tr>
      <td>typeAliases</td>
      <td>자바 클래스 이름(패키지 이름 포함)에 대한 별명 설저</td>
    </tr>
    <tr>
      <td>typeHandler</td>
      <td>칼럼의 값을 자바 객체로, 자바 객체를 칼럼의 값으로 변환해 주는 클래스를 설정</td>
    </tr>
    <tr>
      <td>environments</td>
      <td>프레임워크에서 사용할 데이터베이스 정보(트랜젝션 관리자, 데이터 소스)를 설정.</td>
    </tr>
    <tr>
      <td>mappers</td>
      <td>SQL맵퍼 파일들이 있는 경로 설정</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<blockquote>
  <p>mybatis는 기본 데이터 형(byte, short, int, long,float, double, boolean, char)이나 랩퍼클래스에 대해 미리 별명을 정의했다.</p>
</blockquote>

<h4 id="environments-"><code class="highlighter-rouge">&lt;environments&gt;</code> 엘리먼트</h4>

<p><code class="highlighter-rouge">&lt;environments&gt;</code>태그는 데이터베이스 환경 정보를 설정할 때 사용하는 태그이다. 이 태그를 이용하면 여러개의 데이터베이스 접속 정보를 설정할 수 있다. 설정된 DB정보 중에서 하나를 선택할 때는 default속성을 사용한다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;environments</span> <span class="na">defaul=</span><span class="s">"development"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/environment&gt;</span>
	<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"test"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/environment&gt;</span>
	<span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"real"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
</code></pre>
</div>

<p>각각의 데이터베이스 접속 정보는 <code class="highlighter-rouge">&lt;environment&gt;</code>태그를 이용하여 정의 한다. id속성은 <code class="highlighter-rouge">&lt;environment&gt;</code>를 구분할 때 사용하는 식별자이다.</p>

<h4 id="environment-"><code class="highlighter-rouge">&lt;environment&gt;</code> 엘리먼트</h4>

<p><code class="highlighter-rouge">&lt;environment&gt;</code>는 트랜잭션 관리 및 데이터 소스를 설정하는 태그이다.</p>

<p><strong>트랜잭션 관리 방식 설정</strong></p>

<p>트랜잭션(Transaction)이란, 여러개의 데이터 변경작업을 하나의 작업으로 묶은 것이다.</p>

<table>
  <thead>
    <tr>
      <th>트랜잭션 관리 유형</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>JDBC</td>
      <td>직접 JDBC의 커밋, 롤백기능을 사용하여 mybatis 자체에서 트랜잭션을 관리</td>
    </tr>
    <tr>
      <td>MANAGED</td>
      <td>서버의 트랜잭션 관리 기능을 이용. 즉 Java EE애플리케이션 서버(JBoss, WebLogic, WebSphere등)나 서블릿 컨테이너(톰캣서버 등)에서 트랜잭션을 관리</td>
    </tr>
  </tbody>
</table>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">&gt;</span>
</code></pre>
</div>

<p><br /></p>

<p><strong>데이터소스설정</strong></p>

<p>mybatis는 JDBC 표준 인터페이스인 javax.sql.DataSource구현체를 이용하여 DB 커넥션을 다룬다.</p>

<table>
  <thead>
    <tr>
      <th>데이터소스 유형</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>UNPOOLED</td>
      <td>DB커넥션을 요청할 때마다 매번 커넥션 객체를 생성한다. 높은 성능을 요구하지 않는 단순한 어플리케이션에 적합하다.</td>
    </tr>
    <tr>
      <td>POOLED</td>
      <td>미리 DB커넥션 객체를 생성해두고, 요청하면 즉시 반환한다. 데이터베이스에 연결하는 과정 즉 연결을 초기화하고 사용자를 인증하는 과정이 없기 때문에 속도가 빠르다.</td>
    </tr>
    <tr>
      <td>JNDI</td>
      <td>Java EE 어플리케이션 서버나 서블릿 컨테이너에서 제공하는 데이터 소스를 사용한다.</td>
    </tr>
  </tbody>
</table>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//<span class="nt">&lt;properties&gt;</span>태그에서 설정된 파일을 참조해서 사용함

<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${driver}"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${url}"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${username}"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${password}"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/dataSource&gt;</span>
</code></pre>
</div>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"JNDI"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"data_source"</span> <span class="na">value=</span><span class="s">"java:comp/env/jdbc/studydb"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/dataSource&gt;</span>
</code></pre>
</div>

<p><br /></p>

<h4 id="mappers-"><code class="highlighter-rouge">&lt;mappers&gt;</code> 엘리먼트</h4>

<p><code class="highlighter-rouge">&lt;mappers&gt;</code>태그는 SQL 맵퍼 파일들의 정보를 설정할 때 사용한다. 각각의 SQL 맵퍼 파일의 정보는 <code class="highlighter-rouge">&lt;mapper&gt;</code>태그로 정의한다.</p>

<p>SQL맵퍼 파일의 경로를 설정할 때, 두가지 방법이 있다. 자바 클래스 경로를 사용하는 방법과 운영체제의 파일 시스템 경로를 사용하는 방법이 있다.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//클래스 경로를 사용할 경우
<span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"spms/dao/MySqlProjectDao.xml"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"spms/dao/MySqlMemberDao.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre>
</div>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>//파일 시스템 경로를 사용할 경우
<span class="nt">&lt;mappers&gt;</span>
	<span class="nt">&lt;mapper</span> <span class="na">url=</span><span class="s">"file:///c:/dao/MySqlProjectDao.xml"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre>
</div>

<p><br /></p>

<h3 id="reference">Reference</h3>
<ul>
  <li><a href="http://www.yes24.com/24/Goods/13159413?Acode=101">열혈강의 자바 웹 개발 워크북</a></li>
</ul>

                </div>
                <div class="read-all">
                    <a  href="/2016/09/18/mybatis/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/17/reflection_property/">리플렉션API와 프로퍼티를 이용한 객체관리</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-17
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="reflection-api">1. Reflection API</h1>

<p>리플렉션이란 객체를 통해 클래스의 정보를 분석해 내는 프로그램 기법을 말한다. 투영, 반사 라는 사전적인 의미를 지니고 있다.</p>

<p>자바는 스크립트 언어가 아닌 컴파일 언어이다. 물론 .java -&gt; .class -&gt; 실행이라는 2단계의 메커니즘을 가지고 있지만 컴파일 언어로 분리하는 게 옳다. 원래 자바에서는 동적으로 객체를 생성하는 기술이 없었다. 그리고 동적으로 인스턴스를 생성하는 Reflection으로 그 역활을 대신하게 된다.</p>

<p>즉 클래스나 메서드의 내부 구조를 들여다 볼 때 사용하는 도구라는 뜻이다.<br /></p>


                </div>
                <div class="read-all">
                    <a  href="/2016/09/17/reflection_property/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/16/frontcontroller_dietc/">프런트 컨트롤러 패턴과 의존성주입</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-16
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="section">1. 프런트 컨트롤러 패턴</h1>

<p>MVC구조에서 좀 더 유지보수가 쉬운 구조로 개선 한 것으로 두개의 컨트롤러를 사용하여 웹 브라우저 요청을 처리한다. 프론트 컨트롤러는 VO 객체의 준비, 뷰 컴포넌트의 위임, 오류 처리 등과 같은 공동 작업을 담당하고, 페이지 컨트롤러는 이름 그대로 요청한 페이지만을 위한 작업을 수행한다.</p>

<p><img src="http://joswlv.github.io/images/frontcontroller.png" alt="" /></p>

<ol>
  <li>웹 브라우저는 회원 목록 페이지를 요청한다.</li>
  <li>프런트 컨트롤러 <code class="highlighter-rouge">DispatcherServlet</code>은 회원 목록 요청 처리를 담당하는 페이지 컨트롤러를 호출한다. 이때 데이터를 주고받을 바구니 역할을 할 Map 객체를 넘긴다.</li>
  <li>페이지 컨트롤러 <code class="highlighter-rouge">MemverListController</code>는 Dao에게 회원 목록 데이터를 요청한다.</li>
  <li>MemberDao는 데이터베이스로 부터 회원 목록 데이터를 가져와서, Member객체에 담아 반환한다.</li>
  <li>페이지 컨트롤러는 Dao가 반환한 회원 목록 데이터를 Map 객체에 저장한다. 그리고 프런트 컨트롤러에게 뷰 URL을 반환한다.</li>
  <li>프런트 컨트롤러는 Map객체에 저장된 페이지 컨트롤러의 작업 결과물을 JSP가 사용할 수 있도록 ServletRequest로 옮긴다.</li>
</ol>

<p>프런트 컨트롤러가 페이지 컨트롤러에게 작업을 위임할때 <code class="highlighter-rouge">execute()</code>메서드를 호출한다. 이렇게 호출하기 위해서 페이지 컨트롤러 클래스를 대표하는 Interface를 만들고 <code class="highlighter-rouge">execute()</code>메서드를 상속받게 만든다. 그러면 일관성있는 사용을 보장할 수 있다.</p>

<p>페이지 컨트롤러를 서블릿이 아닌 자바파일로 만들었기 때문에, Dao에서 리턴받은 결과값을 Map을 사용하여 데이터 저장하여, 프런트 컨트롤러로 전달한다. 프런트 컨트롤러에서는 jsp에서 이 데이터들을 사용하기 위해 서블릿 보관소에 저장한다. 이런 과정을 프런트 컨트롤러 패턴이라고 한다. <br /></p>

<h1 id="didependency-injection---">2. DI(Dependency Injection)을 이용한 의존성 과리</h1>

<p>의존 객체를 사용하는 쪽과 의존 객체(또는 보관소) 사이의 결합도가 높아져서 의존 객체나 보관소에 변경이 발생하면 바로 영향을 받는다. 그리고 의존 객체를 다른 객체로 대체하기 가 어렵다. 이런 문제를 해결하기 위해 의존 객체를 외부에서 주입받는 방식이 등장하였다.</p>

<p>이의존객체를 전문으로 관리하는 <code class="highlighter-rouge">빈컨테이너(Java Beans Container)</code>를 사용한다. 빈컨테이너는 객체가 실행되기 전에 그 객체가 필요로 하는 의존 객체를 주입해주는 역할을 수행한다. 이런방식으로 의존 객체를 관리하는 것을 <code class="highlighter-rouge">의존성주입(DI:Dependency Injection)</code> 좀 더 일반적으로 <code class="highlighter-rouge">역제어(IoC:Inversion of Control)</code>라고 한다. 즉 역제어 방식의 한 예가 의존성 주입이다.</p>

<p>하지만 이 방법으로는 <code class="highlighter-rouge">DispatcherServlet</code>의 경우 페이지 컨트롤러가 추가 될 때마다 조건문을 변경해야하고, <code class="highlighter-rouge">ContextLoaderListener</code>도 Dao나 페이지 컨트롤러가 추가될 때마다 변경해야하는 문제가 있다.
<br /></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">// 의존 객체 주입을 위해 인스턴스 변수와 셋터 메서드 추가</span>
<span class="c1">//- 또한 의존 객체를 꺼내는 기존 코드 변경</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberListController</span> <span class="kd">implements</span> <span class="n">Controller</span> <span class="o">{</span>
  <span class="n">MemberDao</span> <span class="n">memberDao</span><span class="o">;</span>
  
  <span class="kd">public</span> <span class="n">MemberListController</span> <span class="nf">setMemberDao</span><span class="o">(</span><span class="n">MemberDao</span> <span class="n">memberDao</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">memberDao</span> <span class="o">=</span> <span class="n">memberDao</span><span class="o">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">execute</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"members"</span><span class="o">,</span> <span class="n">memberDao</span><span class="o">.</span><span class="na">selectList</span><span class="o">());</span>
    <span class="k">return</span> <span class="s">"/member/MemberList.jsp"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">// ServletContext에 보관된 페이지 컨트롤러를 사용</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"serial"</span><span class="o">)</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"*.do"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DispatcherServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span>
      <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
      <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html; charset=UTF-8"</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">servletPath</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getServletPath</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">ServletContext</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
      
      <span class="c1">// 페이지 컨트롤러에게 전달할 Map 객체를 준비한다. </span>
      <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
      <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"session"</span><span class="o">,</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">());</span>
      
      <span class="n">Controller</span> <span class="n">pageController</span> <span class="o">=</span> <span class="o">(</span><span class="n">Controller</span><span class="o">)</span> <span class="n">sc</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">servletPath</span><span class="o">);</span>
      
      <span class="k">if</span> <span class="o">(</span><span class="s">"/member/add.do"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">servletPath</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"member"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Member</span><span class="o">()</span>
            <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"password"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"name"</span><span class="o">)));</span>
        <span class="o">}</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"/member/update.do"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">servletPath</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"member"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Member</span><span class="o">()</span>
            <span class="o">.</span><span class="na">setNo</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"no"</span><span class="o">)))</span>
            <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"name"</span><span class="o">)));</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
          <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"no"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"no"</span><span class="o">)));</span>
        <span class="o">}</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"/member/delete.do"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">servletPath</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"no"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"no"</span><span class="o">)));</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"/auth/login.do"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">servletPath</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">model</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"loginInfo"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Member</span><span class="o">()</span>
            <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"email"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"password"</span><span class="o">)));</span>
        <span class="o">}</span>
      <span class="o">}</span>
      
      <span class="c1">// 페이지 컨트롤러를 실행한다.</span>
      <span class="n">String</span> <span class="n">viewUrl</span> <span class="o">=</span> <span class="n">pageController</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">model</span><span class="o">);</span>
      
      <span class="c1">// Map 객체에 저장된 값을 ServletRequest에 복사한다.</span>
      <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">key</span> <span class="o">:</span> <span class="n">model</span><span class="o">.</span><span class="na">keySet</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">model</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
      <span class="o">}</span>
      
      <span class="k">if</span> <span class="o">(</span><span class="n">viewUrl</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"redirect:"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">viewUrl</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">9</span><span class="o">));</span>
        <span class="k">return</span><span class="o">;</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">RequestDispatcher</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="n">viewUrl</span><span class="o">);</span>
        <span class="n">rd</span><span class="o">.</span><span class="na">include</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
      <span class="o">}</span>
      
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"error"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
      <span class="n">RequestDispatcher</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/Error.jsp"</span><span class="o">);</span>
      <span class="n">rd</span><span class="o">.</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@WebListener</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ContextLoaderListener</span> <span class="kd">implements</span> <span class="n">ServletContextListener</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">contextInitialized</span><span class="o">(</span><span class="n">ServletContextEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">ServletContext</span> <span class="n">sc</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
      
      <span class="n">InitialContext</span> <span class="n">initialContext</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialContext</span><span class="o">();</span>
      <span class="n">DataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="o">(</span><span class="n">DataSource</span><span class="o">)</span><span class="n">initialContext</span><span class="o">.</span><span class="na">lookup</span><span class="o">(</span>
          <span class="s">"java:comp/env/jdbc/studydb"</span><span class="o">);</span>
      
      <span class="n">MemberDao</span> <span class="n">memberDao</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MemberDao</span><span class="o">();</span>
      <span class="n">memberDao</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">ds</span><span class="o">);</span>
      
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/auth/login.do"</span><span class="o">,</span> 
          <span class="k">new</span> <span class="nf">LogInController</span><span class="o">().</span><span class="na">setMemberDao</span><span class="o">(</span><span class="n">memberDao</span><span class="o">));</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/auth/logout.do"</span><span class="o">,</span> <span class="k">new</span> <span class="n">LogOutController</span><span class="o">());</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/member/list.do"</span><span class="o">,</span> 
          <span class="k">new</span> <span class="nf">MemberListController</span><span class="o">().</span><span class="na">setMemberDao</span><span class="o">(</span><span class="n">memberDao</span><span class="o">));</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/member/add.do"</span><span class="o">,</span> 
          <span class="k">new</span> <span class="nf">MemberAddController</span><span class="o">().</span><span class="na">setMemberDao</span><span class="o">(</span><span class="n">memberDao</span><span class="o">));</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/member/update.do"</span><span class="o">,</span> 
          <span class="k">new</span> <span class="nf">MemberUpdateController</span><span class="o">().</span><span class="na">setMemberDao</span><span class="o">(</span><span class="n">memberDao</span><span class="o">));</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"/member/delete.do"</span><span class="o">,</span> 
          <span class="k">new</span> <span class="nf">MemberDeleteController</span><span class="o">().</span><span class="na">setMemberDao</span><span class="o">(</span><span class="n">memberDao</span><span class="o">));</span>
      
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">contextDestroyed</span><span class="o">(</span><span class="n">ServletContextEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{}</span>
<span class="o">}</span>
</code></pre>
</div>
<p><br /></p>

<h3 id="reference">Reference</h3>
<ul>
  <li><a href="http://www.yes24.com/24/Goods/13159413?Acode=101">열혈강의 자바 웹 개발 워크북</a></li>
</ul>

                </div>
                <div class="read-all">
                    <a  href="/2016/09/16/frontcontroller_dietc/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/15/dbconnection/">DB커넥션 관련 정리</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-15
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="daodata-access-object">1. DAO(Data Access Object)</h1>

<p>DAO는 데이터 처리를 전문으로 하는 객체이다. 데이터베이스나 파일, 메모리 등을 이용하여 애플리케이션 데이터를 생성, 조회, 변경, 삭제하는 역할을 수행한다. DAO는 보통 하나의 DB테이블이나 DB뷰에 대응하고, 여러개의 테이블을 조인(join)한 데이터도 다룬다.</p>

<p><img src="http://joswlv.github.io/images/dao.png" alt="" /></p>

<ol>
  <li>웹브라우저에서 회원 목록을 요청한다.</li>
  <li>MemeberListServlet은 회원 목록 데이터를 얻기 위해 MemberDao의 메서드를 호출한다.</li>
  <li>MemeberDao는 데이터베이스로부터 회원 정보를 가져온다.</li>
  <li>MemberDao는 겨로가 레코드의 개수만큼 Member객체를 만들어 서블릿에게 반환한다.</li>
  <li>MemberListServlet은 MemberDao로 부터 받은 회원 목록을 MemberList.jsp에 전달한다.</li>
  <li>MemberList.jsp는 회원 목록 데이터를 가지고 화면을 생성한다. 그리고 제어권을 MemberListServlet에게 넘긴다.</li>
  <li>MemberListServlet에게 넘긴다.</li>
</ol>

<p><strong>예&gt;</strong></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberDao</span> <span class="o">{</span>
  <span class="n">Connection</span> <span class="n">connection</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setConnection</span><span class="o">(</span><span class="n">Connection</span> <span class="n">connection</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">connection</span> <span class="o">=</span> <span class="n">connection</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">selectList</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="n">stmt</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
      <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span>
          <span class="s">"SELECT MNO,MNAME,EMAIL,CRE_DATE"</span> <span class="o">+</span> 
              <span class="s">" FROM MEMBERS"</span> <span class="o">+</span>
          <span class="s">" ORDER BY MNO ASC"</span><span class="o">);</span>

      <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;();</span>

      <span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">members</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Member</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setNo</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"MNO"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"MNAME"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"EMAIL"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">setCreatedDate</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="s">"CRE_DATE"</span><span class="o">))</span>	<span class="o">);</span>
      <span class="o">}</span>

      <span class="k">return</span> <span class="n">members</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="n">e</span><span class="o">;</span>

    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span><span class="k">if</span> <span class="o">(</span><span class="n">rs</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
      <span class="k">try</span> <span class="o">{</span><span class="k">if</span> <span class="o">(</span><span class="n">stmt</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="n">stmt</span><span class="o">.</span><span class="na">close</span><span class="o">();}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> 
</code></pre>
</div>

<p>위의 예에서 두가지를 배울 수 있다.</p>

<ul>
  <li>
    <p>첫번째는 <code class="highlighter-rouge">프로그래밍의 유연성</code>이다. <code class="highlighter-rouge">selectList()</code>에서 리턴 타입이 List인터페이스인 것이다. 하지만 실제 리턴값은 ArrayList객체이다. 이런것을 프로그래밍의 유연성이라고 한다.</p>
  </li>
  <li>
    <p>두번째는 <code class="highlighter-rouge">의존성주입(DI, Dependency Injection)</code> 다른말로 <code class="highlighter-rouge">역제어(IoC, Inversion of Control)</code>이다. connection 인스턴스 변수와 셋터 메서드는 MemberDao에서 ServletContext에 접근할 수 없기 때문에, ServletContext에 보관된 DB Connectoin 객체를 꺼낼 수 없어 필요하다. 외부로 부터 Connection객체를 connection 인스턴스변수와 셋터 메서드에 주입한다. 이런 것을 의존성 주입 또는 역제어라고 한다.<br /></p>
  </li>
</ul>

<h1 id="servlet---listener">2. Servlet - Listener</h1>

<p>서블릿 컨테이너는 웹 어플리케이션의 상태를 모니터링 할 수 있도록 웹어플리케이션의 시작에서 종료까지 주요한 사건에 대한 알람기능을 제공한다. 이를 사용하기 위해 규칙에 따라 객체를 만들어 DD파일에 등록하면 된다.</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/09/15/dbconnection/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/09/13/jsp_tag/">JSP 각종 태그들</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-09-13
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#web" title="Category: web" rel="category">web</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                </div>
                <div class="excerpt">
                    <h1 id="jsp--">1. JSP 액션 태그</h1>

<table>
  <thead>
    <tr>
      <th>액션</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;jsp:useBean&gt;</td>
      <td>자바 인스턴스를 준비한다. 보관소에서 자바 인스턴스를 꺼내거나, 자바 인스턴스를 새로 만들어 보관소에 저장하는 코드를 생성한다. 자바인스턴스를 자바 빈(Java Bean)이라고 한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:setProperty&gt;</td>
      <td>자바빈의 프로퍼티 값을 설정합니다. 자바 객체의 셋터 메서드를 호출하는 코드를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:getProperty&gt;</td>
      <td>자바빈의 프로퍼티 값을 꺼낸다. 자바 객체의 겟터메서드를 호출하는 코드를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:include&gt;</td>
      <td>정적 또는 동적자원을 인클루딩 하는 자바 코드를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:forward&gt;</td>
      <td>현재 페이지의 실행을 멈추고 다른 정적자원이나 동적자원으로 포워딩하는 자바 코드를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:param&gt;</td>
      <td>jsp:include, jsp:forward, jsp:params의 자식 태그로 사용할 수 있다. ServletRequest 객체에 매게변수를 추가하는 코드를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:plugin&gt;</td>
      <td>Object 또는 Embed HTML태그를 생성한다.</td>
    </tr>
    <tr>
      <td>&lt;jsp:element&gt;</td>
      <td>임의의 xml태그나 html태그를 생성한다.</td>
    </tr>
  </tbody>
</table>

<h4 id="jspusebean-">jsp:useBean 문법</h4>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="o">&lt;</span><span class="nl">jsp:</span><span class="n">useBean</span> <span class="n">id</span> <span class="o">=</span> <span class="err">'이름'</span> <span class="n">scope</span><span class="o">=</span><span class="s">"page|request|session|application"</span>
			<span class="kd">class</span><span class="err">="클래스명"</span> <span class="nc">type</span><span class="o">=</span><span class="s">"타입명"</span> <span class="o">/&gt;</span>
</code></pre>
</div>

<h4 id="jspusebean--1"><jsp:useBean> 사용예</jsp:useBean></h4>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="o">&lt;</span><span class="nl">jsp:</span><span class="n">useBean</span> <span class="n">id</span><span class="o">=</span><span class="s">"members"</span>
			<span class="n">scope</span><span class="o">=</span><span class="s">"request"</span>
			<span class="kd">class</span><span class="err">="</span><span class="nc">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="s">"
			type="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="o">&lt;</span><span class="n">spms</span><span class="o">.</span><span class="na">vo</span><span class="o">.</span><span class="na">Member</span><span class="o">&gt;</span><span class="err">"</span><span class="o">/&gt;</span>
</code></pre>
</div>

<ul>
  <li>id 속성 - 객체이름을 설정한다. 이 이름을 사용하여 보관소로부터 값을 꺼낸다. 또 꺼낸 객체의 참조 변수이름으로 사용한다.</li>
  <li>scope 속성 - 기존의 객체를 조회하거나 새로 만든 객체를 저장할 보관소를 지정한다.</li>
  <li>class 속성 - 자바 객체를 생성할 때 사용할 클래스 이름을 지정한다. 클래스 이름은 반드시 패키지 이름을 포함해야하고, 인터페이스 이름은 안된다.</li>
  <li>type 속성 - 참조 변수를 선언할 때 사용할 타입의 이름입니다. 클래스 이름 또는 인터페이스 이름이 올 수 있다.</li>
</ul>


                </div>
                <div class="read-all">
                    <a  href="/2016/09/13/jsp_tag/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <a href="/index.html" class="previous"><i class="fa fa-angle-double-left"></i></a>
            <a href="/page2" class="previous"><i class="fa fa-angle-left"></i></a>
          
          <span class="page_number ">3/5</span>
          
            <a href="/page4" class="next"><i class="fa fa-angle-right"></i></a>
            <a href="/page5" class="next"><i class="fa fa-angle-double-right"></i></a>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#js" class="categories-list-item" cate="js">
                            <span class="name">
                                js
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#web" class="categories-list-item" cate="web">
                            <span class="name">
                                web
                            </span>
                            <span class="badge">14</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#python" class="categories-list-item" cate="python">
                            <span class="name">
                                python
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Spring" class="categories-list-item" cate="Spring">
                            <span class="name">
                                Spring
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Hadoop" class="categories-list-item" cate="Hadoop">
                            <span class="name">
                                Hadoop
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Java" class="categories-list-item" cate="Java">
                            <span class="name">
                                Java
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Etc" class="categories-list-item" cate="Etc">
                            <span class="name">
                                Etc
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Unix/Linux" class="categories-list-item" cate="Unix/Linux">
                            <span class="name">
                                Unix/Linux
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2016/10/23/awk/">awk 사용법</a></li>
                    
                        <li><a href="/2016/10/23/spc_rsync/">scp 와 rsync - 원격파일정송방법</a></li>
                    
                        <li><a href="/2016/10/14/sqoop/">Sqoop</a></li>
                    
                        <li><a href="/2016/10/13/LogBack/">LogBack in SpringBoot</a></li>
                    
                        <li><a href="/2016/10/11/readingoodcode/"><읽기좋은코드> 요약</a></li>
                    
                        <li><a href="/2016/10/07/Predicate/">Java 8 Predicate</a></li>
                    
                        <li><a href="/2016/10/06/List_remvoeif-Method/">List.removeif Method</a></li>
                    
                        <li><a href="/2016/10/02/Interceptor/">Interceptor</a></li>
                    
                        <li><a href="/2016/09/22/hadoop_ecosystem/">Hadoop Ecosystem</a></li>
                    
                        <li><a href="/2016/09/21/beancontext2/">스프링 IoC컨테이너 ApplicationContext [2]</a></li>
                    
                </ul>
            </div>

<!--
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    Tags
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                </div>
            </div> -->
        </div>
    </div>
</div>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/joswlv" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:wh7923@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>     
            <a href="https://www.facebook.com/wsj7923" title="Facebook"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>    
        </p>
        <p>
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" class="scroll">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/scroll.min.js " charset="utf-8"></script>
  </body>

</html>
